(function($){$.jqplot.LogAxisRenderer=function(){$.jqplot.LinearAxisRenderer.call(this);this.axisDefaults={base:10,tickDistribution:"even"}};$.jqplot.LogAxisRenderer.prototype=new $.jqplot.LinearAxisRenderer();$.jqplot.LogAxisRenderer.prototype.constructor=$.jqplot.LogAxisRenderer;$.jqplot.LogAxisRenderer.prototype.init=function(options){$.extend(true,this.renderer,options);for(var d in this.renderer.axisDefaults){if(this[d]==null){this[d]=this.renderer.axisDefaults[d]}}var db=this._dataBounds;for(var i=0;i<this._series.length;i++){var s=this._series[i];var d=s.data;for(var j=0;j<d.length;j++){if(this.name=="xaxis"||this.name=="x2axis"){if(d[j][0]>db.max||db.max==null){db.max=d[j][0]}if(d[j][0]>db.max||db.max==null){db.max=d[j][0]}}else{if(d[j][1]<db.min||db.min==null){db.min=d[j][1]}if(d[j][1]>db.max||db.max==null){db.max=d[j][1]}}}}};$.jqplot.LogAxisRenderer.prototype.createTicks=function(){var ticks=this._ticks;var userTicks=this.ticks;var name=this.name;var db=this._dataBounds;var dim,interval;var min,max;var pos1,pos2;var tt,i;if(userTicks.length){for(i=0;i<userTicks.length;i++){var ut=userTicks[i];var t=new this.tickRenderer(this.tickOptions);if(ut.constructor==Array){t.value=ut[0];t.label=ut[1];if(!this.showTicks){t.showLabel=false;t.showMark=false}else{if(!this.showTickMarks){t.showMark=false}}t.setTick(ut[0],this.name);this._ticks.push(t)}else{t.value=ut;if(!this.showTicks){t.showLabel=false;t.showMark=false}else{if(!this.showTickMarks){t.showMark=false}}t.setTick(ut,this.name);this._ticks.push(t)}}this.numberTicks=userTicks.length;this.min=this._ticks[0].value;this.max=this._ticks[this.numberTicks-1].value}else{if(name=="xaxis"||name=="x2axis"){dim=this._plotDimensions.width}else{dim=this._plotDimensions.height}min=((this.min!=null)?this.min:db.min);max=((this.max!=null)?this.max:db.max);if(min==max){var adj=0.05;min=min*(1-adj);max=max*(1+adj)}if(this.min!=null&&this.min<=0){throw ("log axis minimum must be greater than 0")}if(this.max!=null&&this.max<=0){throw ("log axis maximum must be greater than 0")}var range=max-min;var rmin,rmax;if(this.tickDistribution=="even"){rmin=(this.min!=null)?this.min:min-min*((this.padMin-1)/2);rmax=(this.max!=null)?this.max:max+max*((this.padMax-1)/2);this.min=rmin;this.max=rmax;range=this.max-this.min;if(this.numberTicks==null){if(dim>100){this.numberTicks=parseInt(3+(dim-100)/75,10)}else{this.numberTicks=2}}var u=Math.pow(this.base,(1/(this.numberTicks-1)*Math.log(this.max/this.min)/Math.log(this.base)));for(var i=0;i<this.numberTicks;i++){tt=this.min*Math.pow(u,i);var t=new this.tickRenderer(this.tickOptions);if(!this.showTicks){t.showLabel=false;t.showMark=false}else{if(!this.showTickMarks){t.showMark=false}}t.setTick(tt,this.name);this._ticks.push(t)}}else{if(this.tickDistribution=="power"){rmin=Math.pow(this.base,Math.ceil(Math.log(min*(2-this.padMin))/Math.log(this.base))-1);rmax=Math.pow(this.base,Math.floor(Math.log(max*this.padMax)/Math.log(this.base))+1);this.min=rmin;this.max=rmax;range=this.max-this.min;var fittedTicks=0;var minorTicks=0;if(this.numberTicks==null){if(dim>100){this.numberTicks=Math.round(Math.log(this.max/this.min)/Math.log(this.base)+1);if(this.numberTicks<2){this.numberTicks=2}fittedTicks=parseInt(3+(dim-100)/75,10)}else{this.numberTicks=2;fittedTicks=2}if(this.numberTicks<fittedTicks-1){minorTicks=Math.floor(fittedTicks/this.numberTicks)}}for(var i=0;i<this.numberTicks;i++){tt=Math.pow(this.base,i-this.numberTicks+1)*this.max;var t=new this.tickRenderer(this.tickOptions);if(!this.showTicks){t.showLabel=false;t.showMark=false}else{if(!this.showTickMarks){t.showMark=false}}t.setTick(tt,this.name);this._ticks.push(t);if(minorTicks&&i<this.numberTicks-1){var tt1=Math.pow(this.base,i-this.numberTicks+2)*this.max;var spread=tt1-tt;var interval=tt1/(minorTicks+1);for(var j=minorTicks-1;j>=0;j--){var val=tt1-interval*(j+1);var t=new this.tickRenderer(this.tickOptions);if(!this.showTicks){t.showLabel=false;t.showMark=false}else{if(!this.showTickMarks){t.showMark=false}}t.setTick(val,this.name);this._ticks.push(t)}}}}}}};$.jqplot.LogAxisRenderer.prototype.pack=function(pos,offsets){var lb=parseInt(this.base,10);var ticks=this._ticks;var trans=function(v){return Math.log(v)/Math.log(lb)};var invtrans=function(v){return Math.pow(Math.E,(Math.log(lb)*v))};max=trans(this.max);min=trans(this.min);var offmax=offsets.max;var offmin=offsets.min;var lshow=(this._label==null)?false:this._label.show;for(var p in pos){this._elem.css(p,pos[p])}this._offsets=offsets;var pixellength=offmax-offmin;var unitlength=max-min;this.p2u=function(p){return invtrans((p-offmin)*unitlength/pixellength+min)};this.u2p=function(u){return(trans(u)-min)*pixellength/unitlength+offmin};if(this.name=="xaxis"||this.name=="x2axis"){this.series_u2p=function(u){return(trans(u)-min)*pixellength/unitlength};this.series_p2u=function(p){return invtrans(p*unitlength/pixellength+min)}}else{this.series_u2p=function(u){return(trans(u)-max)*pixellength/unitlength};this.series_p2u=function(p){return invtrans(p*unitlength/pixellength+max)}}if(this.show){if(this.name=="xaxis"||this.name=="x2axis"){for(i=0;i<ticks.length;i++){var t=ticks[i];if(t.show&&t.showLabel){var shim;if(t.constructor==$.jqplot.CanvasAxisTickRenderer&&t.angle){switch(t.labelPosition){case"auto":if(t.angle<0){shim=-t.getWidth()+t._textRenderer.height*Math.sin(-t._textRenderer.angle)/2}else{shim=-t._textRenderer.height*Math.sin(t._textRenderer.angle)/2}break;case"end":shim=-t.getWidth()+t._textRenderer.height*Math.sin(-t._textRenderer.angle)/2;break;case"start":shim=-t._textRenderer.height*Math.sin(t._textRenderer.angle)/2;break;case"middle":shim=-t.getWidth()/2+t._textRenderer.height*Math.sin(-t._textRenderer.angle)/2;break;default:shim=-t.getWidth()/2+t._textRenderer.height*Math.sin(-t._textRenderer.angle)/2;break}}else{shim=-t.getWidth()/2}var val=this.u2p(t.value)+shim+"px";t._elem.css("left",val);t.pack()}}if(lshow){var w=this._label._elem.outerWidth(true);this._label._elem.css("left",offmin+pixellength/2-w/2+"px");if(this.name=="xaxis"){this._label._elem.css("bottom","0px")}else{this._label._elem.css("top","0px")}this._label.pack()}}else{for(i=0;i<ticks.length;i++){var t=ticks[i];if(t.show&&t.showLabel){var shim;if(t.constructor==$.jqplot.CanvasAxisTickRenderer&&t.angle){switch(t.labelPosition){case"auto":case"end":if(t.angle<0){shim=-t._textRenderer.height*Math.cos(-t._textRenderer.angle)/2}else{shim=-t.getHeight()+t._textRenderer.height*Math.cos(t._textRenderer.angle)/2}break;case"start":if(t.angle>0){shim=-t._textRenderer.height*Math.cos(-t._textRenderer.angle)/2}else{shim=-t.getHeight()+t._textRenderer.height*Math.cos(t._textRenderer.angle)/2}break;case"middle":shim=-t.getHeight()/2;break;default:shim=-t.getHeight()/2;break}}else{shim=-t.getHeight()/2}var val=this.u2p(t.value)+shim+"px";t._elem.css("top",val);t.pack()}}if(lshow){var h=this._label._elem.outerHeight(true);this._label._elem.css("top",offmax-pixellength/2-h/2+"px");if(this.name=="yaxis"){this._label._elem.css("left","0px")}else{this._label._elem.css("right","0px")}this._label.pack()}}}}})(jQuery);(function($){$.jqplot.BarRenderer=function(){$.jqplot.LineRenderer.call(this)};$.jqplot.BarRenderer.prototype=new $.jqplot.LineRenderer();$.jqplot.BarRenderer.prototype.constructor=$.jqplot.BarRenderer;$.jqplot.BarRenderer.prototype.init=function(options,plot){this.barPadding=8;this.barMargin=10;this.barDirection="vertical";this.barWidth=null;this.shadowOffset=2;this.shadowDepth=5;this.shadowAlpha=0.08;this.waterfall=false;this.groups=1;this.varyBarColor=false;this.highlightMouseOver=true;this.highlightMouseDown=false;this.highlightColors=[];if(options.highlightMouseDown&&options.highlightMouseOver==null){options.highlightMouseOver=false}$.extend(true,this,options);this.fill=true;if(this.waterfall){this.fillToZero=false;this.disableStack=true}if(this.barDirection=="vertical"){this._primaryAxis="_xaxis";this._stackAxis="y";this.fillAxis="y"}else{this._primaryAxis="_yaxis";this._stackAxis="x";this.fillAxis="x"}this._highlightedPoint=null;this._plotSeriesInfo=null;this._dataColors=[];this._barPoints=[];var opts={lineJoin:"miter",lineCap:"round",fill:true,isarc:false,strokeStyle:this.color,fillStyle:this.color,closePath:this.fill};this.renderer.shapeRenderer.init(opts);var sopts={lineJoin:"miter",lineCap:"round",fill:true,isarc:false,angle:this.shadowAngle,offset:this.shadowOffset,alpha:this.shadowAlpha,depth:this.shadowDepth,closePath:this.fill};this.renderer.shadowRenderer.init(sopts);plot.postInitHooks.addOnce(postInit);plot.postDrawHooks.addOnce(postPlotDraw);plot.eventListenerHooks.addOnce("jqplotMouseMove",handleMove);plot.eventListenerHooks.addOnce("jqplotMouseDown",handleMouseDown);plot.eventListenerHooks.addOnce("jqplotMouseUp",handleMouseUp);plot.eventListenerHooks.addOnce("jqplotClick",handleClick);plot.eventListenerHooks.addOnce("jqplotRightClick",handleRightClick)};function barPreInit(target,data,seriesDefaults,options){if(this.rendererOptions.barDirection=="horizontal"){this._stackAxis="x";this._primaryAxis="_yaxis"}if(this.rendererOptions.waterfall==true){this._data=$.extend(true,[],this.data);var sum=0;var pos=(!this.rendererOptions.barDirection||this.rendererOptions.barDirection=="vertical")?1:0;for(var i=0;i<this.data.length;i++){sum+=this.data[i][pos];if(i>0){this.data[i][pos]+=this.data[i-1][pos]}}this.data[this.data.length]=(pos==1)?[this.data.length+1,sum]:[sum,this.data.length+1];this._data[this._data.length]=(pos==1)?[this._data.length+1,sum]:[sum,this._data.length+1]}if(this.rendererOptions.groups>1){this.breakOnNull=true;var l=this.data.length;var skip=parseInt(l/this.rendererOptions.groups,10);var count=0;for(var i=skip;i<l;i+=skip){this.data.splice(i+count,0,[null,null]);count++}for(i=0;i<this.data.length;i++){if(this._primaryAxis=="_xaxis"){this.data[i][0]=i+1}else{this.data[i][1]=i+1}}}}$.jqplot.preSeriesInitHooks.push(barPreInit);$.jqplot.BarRenderer.prototype.calcSeriesNumbers=function(){var nvals=0;var nseries=0;var paxis=this[this._primaryAxis];var s,series,pos;for(var i=0;i<paxis._series.length;i++){series=paxis._series[i];if(series===this){pos=i}if(series.renderer.constructor==$.jqplot.BarRenderer){nvals+=series.data.length;nseries+=1}}return[nvals,nseries,pos]};$.jqplot.BarRenderer.prototype.setBarWidth=function(){var i;var nvals=0;var nseries=0;var paxis=this[this._primaryAxis];var s,series,pos;var temp=this._plotSeriesInfo=this.renderer.calcSeriesNumbers.call(this);nvals=temp[0];nseries=temp[1];var nticks=paxis.numberTicks;var nbins=(nticks-1)/2;if(paxis.name=="xaxis"||paxis.name=="x2axis"){if(this._stack){this.barWidth=(paxis._offsets.max-paxis._offsets.min)/nvals*nseries-this.barMargin}else{this.barWidth=((paxis._offsets.max-paxis._offsets.min)/nbins-this.barPadding*(nseries-1)-this.barMargin*2)/nseries}}else{if(this._stack){this.barWidth=(paxis._offsets.min-paxis._offsets.max)/nvals*nseries-this.barMargin}else{this.barWidth=((paxis._offsets.min-paxis._offsets.max)/nbins-this.barPadding*(nseries-1)-this.barMargin*2)/nseries}}return[nvals,nseries]};function computeHighlightColors(colors){var ret=[];for(var i=0;i<colors.length;i++){var rgba=$.jqplot.getColorComponents(colors[i]);var newrgb=[rgba[0],rgba[1],rgba[2]];var sum=newrgb[0]+newrgb[1]+newrgb[2];for(var j=0;j<3;j++){newrgb[j]=(sum>570)?newrgb[j]*0.8:newrgb[j]+0.3*(255-newrgb[j]);newrgb[j]=parseInt(newrgb[j],10)}ret.push("rgb("+newrgb[0]+","+newrgb[1]+","+newrgb[2]+")")}return ret}$.jqplot.BarRenderer.prototype.draw=function(ctx,gridData,options){var i;var opts=(options!=undefined)?options:{};var shadow=(opts.shadow!=undefined)?opts.shadow:this.shadow;var showLine=(opts.showLine!=undefined)?opts.showLine:this.showLine;var fill=(opts.fill!=undefined)?opts.fill:this.fill;var xaxis=this.xaxis;var yaxis=this.yaxis;var xp=this._xaxis.series_u2p;var yp=this._yaxis.series_u2p;var pointx,pointy,nvals,nseries,pos;this._dataColors=[];this._barPoints=[];if(this.barWidth==null){this.renderer.setBarWidth.call(this)}var temp=this._plotSeriesInfo=this.renderer.calcSeriesNumbers.call(this);nvals=temp[0];nseries=temp[1];pos=temp[2];if(this._stack){this._barNudge=0}else{this._barNudge=(-Math.abs(nseries/2-0.5)+pos)*(this.barWidth+this.barPadding)}if(showLine){var negativeColors=new $.jqplot.ColorGenerator(this.negativeSeriesColors);var positiveColors=new $.jqplot.ColorGenerator(this.seriesColors);var negativeColor=negativeColors.get(this.index);if(!this.useNegativeColors){negativeColor=opts.fillStyle}var positiveColor=opts.fillStyle;if(this.barDirection=="vertical"){for(var i=0;i<gridData.length;i++){if(this.data[i][1]==null){continue}points=[];var base=gridData[i][0]+this._barNudge;var ystart;if(this._stack&&this._prevGridData.length){ystart=this._prevGridData[i][1]}else{if(this.fillToZero){ystart=this._yaxis.series_u2p(0)}else{if(this.waterfall&&i>0&&i<this.gridData.length-1){ystart=this.gridData[i-1][1]}else{ystart=ctx.canvas.height}}}if((this.fillToZero&&this._plotData[i][1]<0)||(this.waterfall&&this._data[i][1]<0)){if(this.varyBarColor&&!this._stack){if(this.useNegativeColors){opts.fillStyle=negativeColors.next()}else{opts.fillStyle=positiveColors.next()}}else{opts.fillStyle=negativeColor}}else{if(this.varyBarColor&&!this._stack){opts.fillStyle=positiveColors.next()}else{opts.fillStyle=positiveColor}}points.push([base-this.barWidth/2,ystart]);points.push([base-this.barWidth/2,gridData[i][1]]);points.push([base+this.barWidth/2,gridData[i][1]]);points.push([base+this.barWidth/2,ystart]);this._barPoints.push(points);if(shadow&&!this._stack){var sopts=$.extend(true,{},opts);delete sopts.fillStyle;this.renderer.shadowRenderer.draw(ctx,points,sopts)}var clr=opts.fillStyle||this.color;this._dataColors.push(clr);this.renderer.shapeRenderer.draw(ctx,points,opts)}}else{if(this.barDirection=="horizontal"){for(var i=0;i<gridData.length;i++){if(this.data[i][0]==null){continue}points=[];var base=gridData[i][1]-this._barNudge;var xstart;if(this._stack&&this._prevGridData.length){xstart=this._prevGridData[i][0]}else{if(this.fillToZero){xstart=this._xaxis.series_u2p(0)}else{if(this.waterfall&&i>0&&i<this.gridData.length-1){xstart=this.gridData[i-1][1]}else{xstart=0}}}if((this.fillToZero&&this._plotData[i][1]<0)||(this.waterfall&&this._data[i][1]<0)){if(this.varyBarColor&&!this._stack){if(this.useNegativeColors){opts.fillStyle=negativeColors.next()}else{opts.fillStyle=positiveColors.next()}}}else{if(this.varyBarColor&&!this._stack){opts.fillStyle=positiveColors.next()}else{opts.fillStyle=positiveColor}}points.push([xstart,base+this.barWidth/2]);points.push([xstart,base-this.barWidth/2]);points.push([gridData[i][0],base-this.barWidth/2]);points.push([gridData[i][0],base+this.barWidth/2]);this._barPoints.push(points);if(shadow&&!this._stack){var sopts=$.extend(true,{},opts);delete sopts.fillStyle;this.renderer.shadowRenderer.draw(ctx,points,sopts)}var clr=opts.fillStyle||this.color;this._dataColors.push(clr);this.renderer.shapeRenderer.draw(ctx,points,opts)}}}}if(this.highlightColors.length==0){this.highlightColors=computeHighlightColors(this._dataColors)}else{if(typeof(this.highlightColors)=="string"){var temp=this.highlightColors;this.highlightColors=[];for(var i=0;i<this._dataColors.length;i++){this.highlightColors.push(temp)}}}};$.jqplot.BarRenderer.prototype.drawShadow=function(ctx,gridData,options){var i;var opts=(options!=undefined)?options:{};var shadow=(opts.shadow!=undefined)?opts.shadow:this.shadow;var showLine=(opts.showLine!=undefined)?opts.showLine:this.showLine;var fill=(opts.fill!=undefined)?opts.fill:this.fill;var xaxis=this.xaxis;var yaxis=this.yaxis;var xp=this._xaxis.series_u2p;var yp=this._yaxis.series_u2p;var pointx,pointy,nvals,nseries,pos;if(this._stack&&this.shadow){if(this.barWidth==null){this.renderer.setBarWidth.call(this)}var temp=this._plotSeriesInfo=this.renderer.calcSeriesNumbers.call(this);nvals=temp[0];nseries=temp[1];pos=temp[2];if(this._stack){this._barNudge=0}else{this._barNudge=(-Math.abs(nseries/2-0.5)+pos)*(this.barWidth+this.barPadding)}if(showLine){if(this.barDirection=="vertical"){for(var i=0;i<gridData.length;i++){if(this.data[i][1]==null){continue}points=[];var base=gridData[i][0]+this._barNudge;var ystart;if(this._stack&&this._prevGridData.length){ystart=this._prevGridData[i][1]}else{if(this.fillToZero){ystart=this._yaxis.series_u2p(0)}else{ystart=ctx.canvas.height}}points.push([base-this.barWidth/2,ystart]);points.push([base-this.barWidth/2,gridData[i][1]]);points.push([base+this.barWidth/2,gridData[i][1]]);points.push([base+this.barWidth/2,ystart]);this.renderer.shadowRenderer.draw(ctx,points,opts)}}else{if(this.barDirection=="horizontal"){for(var i=0;i<gridData.length;i++){if(this.data[i][0]==null){continue}points=[];var base=gridData[i][1]-this._barNudge;var xstart;if(this._stack&&this._prevGridData.length){xstart=this._prevGridData[i][0]}else{xstart=0}points.push([xstart,base+this.barWidth/2]);points.push([gridData[i][0],base+this.barWidth/2]);points.push([gridData[i][0],base-this.barWidth/2]);points.push([xstart,base-this.barWidth/2]);this.renderer.shadowRenderer.draw(ctx,points,opts)}}}}}};function postInit(target,data,options){for(i=0;i<this.series.length;i++){if(this.series[i].renderer.constructor==$.jqplot.BarRenderer){if(this.series[i].highlightMouseOver){this.series[i].highlightMouseDown=false}}}this.target.bind("mouseout",{plot:this},function(ev){unhighlight(ev.data.plot)})}function postPlotDraw(){this.plugins.barRenderer={highlightedSeriesIndex:null};this.plugins.barRenderer.highlightCanvas=new $.jqplot.GenericCanvas();this.eventCanvas._elem.before(this.plugins.barRenderer.highlightCanvas.createElement(this._gridPadding,"jqplot-barRenderer-highlight-canvas",this._plotDimensions));var hctx=this.plugins.barRenderer.highlightCanvas.setContext()}function highlight(plot,sidx,pidx,points){var s=plot.series[sidx];var canvas=plot.plugins.barRenderer.highlightCanvas;canvas._ctx.clearRect(0,0,canvas._ctx.canvas.width,canvas._ctx.canvas.height);s._highlightedPoint=pidx;plot.plugins.barRenderer.highlightedSeriesIndex=sidx;var opts={fillStyle:s.highlightColors[pidx]};s.renderer.shapeRenderer.draw(canvas._ctx,points,opts)}function unhighlight(plot){var canvas=plot.plugins.barRenderer.highlightCanvas;canvas._ctx.clearRect(0,0,canvas._ctx.canvas.width,canvas._ctx.canvas.height);for(var i=0;i<plot.series.length;i++){plot.series[i]._highlightedPoint=null}plot.plugins.barRenderer.highlightedSeriesIndex=null;plot.target.trigger("jqplotDataUnhighlight")}function handleMove(ev,gridpos,datapos,neighbor,plot){if(neighbor){var ins=[neighbor.seriesIndex,neighbor.pointIndex,neighbor.data];var evt1=jQuery.Event("jqplotDataMouseOver");evt1.pageX=ev.pageX;evt1.pageY=ev.pageY;plot.target.trigger(evt1,ins);if(plot.series[ins[0]].highlightMouseOver&&!(ins[0]==plot.plugins.barRenderer.highlightedSeriesIndex&&ins[1]==plot.series[ins[0]]._highlightedPoint)){var evt=jQuery.Event("jqplotDataHighlight");evt.pageX=ev.pageX;evt.pageY=ev.pageY;plot.target.trigger(evt,ins);highlight(plot,neighbor.seriesIndex,neighbor.pointIndex,neighbor.points)}}else{if(neighbor==null){unhighlight(plot)}}}function handleMouseDown(ev,gridpos,datapos,neighbor,plot){if(neighbor){var ins=[neighbor.seriesIndex,neighbor.pointIndex,neighbor.data];if(plot.series[ins[0]].highlightMouseDown&&!(ins[0]==plot.plugins.barRenderer.highlightedSeriesIndex&&ins[1]==plot.series[ins[0]]._highlightedPoint)){var evt=jQuery.Event("jqplotDataHighlight");evt.pageX=ev.pageX;evt.pageY=ev.pageY;plot.target.trigger(evt,ins);highlight(plot,neighbor.seriesIndex,neighbor.pointIndex,neighbor.points)}}else{if(neighbor==null){unhighlight(plot)}}}function handleMouseUp(ev,gridpos,datapos,neighbor,plot){var idx=plot.plugins.barRenderer.highlightedSeriesIndex;if(idx!=null&&plot.series[idx].highlightMouseDown){unhighlight(plot)}}function handleClick(ev,gridpos,datapos,neighbor,plot){if(neighbor){var ins=[neighbor.seriesIndex,neighbor.pointIndex,neighbor.data];var evt=jQuery.Event("jqplotDataClick");evt.pageX=ev.pageX;evt.pageY=ev.pageY;plot.target.trigger(evt,ins)}}function handleRightClick(ev,gridpos,datapos,neighbor,plot){if(neighbor){var ins=[neighbor.seriesIndex,neighbor.pointIndex,neighbor.data];var idx=plot.plugins.barRenderer.highlightedSeriesIndex;if(idx!=null&&plot.series[idx].highlightMouseDown){unhighlight(plot)}var evt=jQuery.Event("jqplotDataRightClick");evt.pageX=ev.pageX;evt.pageY=ev.pageY;plot.target.trigger(evt,ins)}}})(jQuery);(function($){$.jqplot.CategoryAxisRenderer=function(options){$.jqplot.LinearAxisRenderer.call(this);this.sortMergedLabels=false};$.jqplot.CategoryAxisRenderer.prototype=new $.jqplot.LinearAxisRenderer();$.jqplot.CategoryAxisRenderer.prototype.constructor=$.jqplot.CategoryAxisRenderer;$.jqplot.CategoryAxisRenderer.prototype.init=function(options){this.groups=1;this.groupLabels=[];this._groupLabels=[];this._grouped=false;this._barsPerGroup=null;$.extend(true,this,{tickOptions:{formatString:"%d"}},options);var db=this._dataBounds;for(var i=0;i<this._series.length;i++){var s=this._series[i];if(s.groups){this.groups=s.groups}var d=s.data;for(var j=0;j<d.length;j++){if(this.name=="xaxis"||this.name=="x2axis"){if(d[j][0]<db.min||db.min==null){db.min=d[j][0]}if(d[j][0]>db.max||db.max==null){db.max=d[j][0]}}else{if(d[j][1]<db.min||db.min==null){db.min=d[j][1]}if(d[j][1]>db.max||db.max==null){db.max=d[j][1]}}}}if(this.groupLabels.length){this.groups=this.groupLabels.length}};$.jqplot.CategoryAxisRenderer.prototype.createTicks=function(){var ticks=this._ticks;var userTicks=this.ticks;var name=this.name;var db=this._dataBounds;var dim,interval;var min,max;var pos1,pos2;var tt,i;if(userTicks.length){if(this.groups>1&&!this._grouped){var l=userTicks.length;var skip=parseInt(l/this.groups,10);var count=0;for(var i=skip;i<l;i+=skip){userTicks.splice(i+count,0," ");count++}this._grouped=true}this.min=0.5;this.max=userTicks.length+0.5;var range=this.max-this.min;this.numberTicks=2*userTicks.length+1;for(i=0;i<userTicks.length;i++){tt=this.min+2*i*range/(this.numberTicks-1);var t=new this.tickRenderer(this.tickOptions);t.showLabel=false;t.setTick(tt,this.name);this._ticks.push(t);var t=new this.tickRenderer(this.tickOptions);t.label=userTicks[i];t.showMark=false;t.showGridline=false;t.setTick(tt+0.5,this.name);this._ticks.push(t)}var t=new this.tickRenderer(this.tickOptions);t.showLabel=false;t.setTick(tt+1,this.name);this._ticks.push(t)}else{if(name=="xaxis"||name=="x2axis"){dim=this._plotDimensions.width}else{dim=this._plotDimensions.height}if(this.min!=null&&this.max!=null&&this.numberTicks!=null){this.tickInterval=null}if(this.min!=null&&this.max!=null&&this.tickInterval!=null){if(parseInt((this.max-this.min)/this.tickInterval,10)!=(this.max-this.min)/this.tickInterval){this.tickInterval=null}}var labels=[];var numcats=0;var min=0.5;var max,val;var isMerged=false;for(var i=0;i<this._series.length;i++){var s=this._series[i];for(var j=0;j<s.data.length;j++){if(this.name=="xaxis"||this.name=="x2axis"){val=s.data[j][0]}else{val=s.data[j][1]}if($.inArray(val,labels)==-1){isMerged=true;numcats+=1;labels.push(val)}}}if(isMerged&&this.sortMergedLabels){labels.sort(function(a,b){return a-b})}this.ticks=labels;for(var i=0;i<this._series.length;i++){var s=this._series[i];for(var j=0;j<s.data.length;j++){if(this.name=="xaxis"||this.name=="x2axis"){val=s.data[j][0]}else{val=s.data[j][1]}var idx=$.inArray(val,labels)+1;if(this.name=="xaxis"||this.name=="x2axis"){s.data[j][0]=idx}else{s.data[j][1]=idx}}}if(this.groups>1&&!this._grouped){var l=labels.length;var skip=parseInt(l/this.groups,10);var count=0;for(var i=skip;i<l;i+=skip+1){labels[i]=" "}this._grouped=true}max=numcats+0.5;if(this.numberTicks==null){this.numberTicks=2*numcats+1}var range=max-min;this.min=min;this.max=max;var track=0;var maxVisibleTicks=parseInt(3+dim/20,10);var skip=parseInt(numcats/maxVisibleTicks,10);if(this.tickInterval==null){this.tickInterval=range/(this.numberTicks-1)}for(var i=0;i<this.numberTicks;i++){tt=this.min+i*this.tickInterval;var t=new this.tickRenderer(this.tickOptions);if(i/2==parseInt(i/2,10)){t.showLabel=false;t.showMark=true}else{if(skip>0&&track<skip){t.showLabel=false;track+=1}else{t.showLabel=true;track=0}t.label=t.formatter(t.formatString,labels[(i-1)/2]);t.showMark=false;t.showGridline=false}t.setTick(tt,this.name);this._ticks.push(t)}}};$.jqplot.CategoryAxisRenderer.prototype.draw=function(ctx){if(this.show){this.renderer.createTicks.call(this);var dim=0;var temp;if(this._elem){this._elem.empty()}this._elem=this._elem||$('<div class="jqplot-axis jqplot-'+this.name+'" style="position:absolute;"></div>');if(this.name=="xaxis"||this.name=="x2axis"){this._elem.width(this._plotDimensions.width)}else{this._elem.height(this._plotDimensions.height)}this.labelOptions.axis=this.name;this._label=new this.labelRenderer(this.labelOptions);if(this._label.show){var elem=this._label.draw(ctx);elem.appendTo(this._elem)}var t=this._ticks;for(var i=0;i<t.length;i++){var tick=t[i];if(tick.showLabel&&(!tick.isMinorTick||this.showMinorTicks)){var elem=tick.draw(ctx);elem.appendTo(this._elem)}}this._groupLabels=[];for(var i=0;i<this.groupLabels.length;i++){var elem=$('<div style="position:absolute;" class="jqplot-'+this.name+'-groupLabel"></div>');elem.html(this.groupLabels[i]);this._groupLabels.push(elem);elem.appendTo(this._elem)}}return this._elem};$.jqplot.CategoryAxisRenderer.prototype.set=function(){var dim=0;var temp;var w=0;var h=0;var lshow=(this._label==null)?false:this._label.show;if(this.show){var t=this._ticks;for(var i=0;i<t.length;i++){var tick=t[i];if(tick.showLabel&&(!tick.isMinorTick||this.showMinorTicks)){if(this.name=="xaxis"||this.name=="x2axis"){temp=tick._elem.outerHeight(true)}else{temp=tick._elem.outerWidth(true)}if(temp>dim){dim=temp}}}var dim2=0;for(var i=0;i<this._groupLabels.length;i++){var l=this._groupLabels[i];if(this.name=="xaxis"||this.name=="x2axis"){temp=l.outerHeight(true)}else{temp=l.outerWidth(true)}if(temp>dim2){dim2=temp}}if(lshow){w=this._label._elem.outerWidth(true);h=this._label._elem.outerHeight(true)}if(this.name=="xaxis"){dim+=dim2+h;this._elem.css({height:dim+"px",left:"0px",bottom:"0px"})}else{if(this.name=="x2axis"){dim+=dim2+h;this._elem.css({height:dim+"px",left:"0px",top:"0px"})}else{if(this.name=="yaxis"){dim+=dim2+w;this._elem.css({width:dim+"px",left:"0px",top:"0px"});if(lshow&&this._label.constructor==$.jqplot.AxisLabelRenderer){this._label._elem.css("width",w+"px")}}else{dim+=dim2+w;this._elem.css({width:dim+"px",right:"0px",top:"0px"});if(lshow&&this._label.constructor==$.jqplot.AxisLabelRenderer){this._label._elem.css("width",w+"px")}}}}}};$.jqplot.CategoryAxisRenderer.prototype.pack=function(pos,offsets){var ticks=this._ticks;var max=this.max;var min=this.min;var offmax=offsets.max;var offmin=offsets.min;var lshow=(this._label==null)?false:this._label.show;for(var p in pos){this._elem.css(p,pos[p])}this._offsets=offsets;var pixellength=offmax-offmin;var unitlength=max-min;this.p2u=function(p){return(p-offmin)*unitlength/pixellength+min};this.u2p=function(u){return(u-min)*pixellength/unitlength+offmin};if(this.name=="xaxis"||this.name=="x2axis"){this.series_u2p=function(u){return(u-min)*pixellength/unitlength};this.series_p2u=function(p){return p*unitlength/pixellength+min}}else{this.series_u2p=function(u){return(u-max)*pixellength/unitlength};this.series_p2u=function(p){return p*unitlength/pixellength+max}}if(this.show){if(this.name=="xaxis"||this.name=="x2axis"){for(i=0;i<ticks.length;i++){var t=ticks[i];if(t.show&&t.showLabel){var shim;if(t.constructor==$.jqplot.CanvasAxisTickRenderer&&t.angle){var temp=(this.name=="xaxis")?1:-1;switch(t.labelPosition){case"auto":if(temp*t.angle<0){shim=-t.getWidth()+t._textRenderer.height*Math.sin(-t._textRenderer.angle)/2}else{shim=-t._textRenderer.height*Math.sin(t._textRenderer.angle)/2}break;case"end":shim=-t.getWidth()+t._textRenderer.height*Math.sin(-t._textRenderer.angle)/2;break;case"start":shim=-t._textRenderer.height*Math.sin(t._textRenderer.angle)/2;break;case"middle":shim=-t.getWidth()/2+t._textRenderer.height*Math.sin(-t._textRenderer.angle)/2;break;default:shim=-t.getWidth()/2+t._textRenderer.height*Math.sin(-t._textRenderer.angle)/2;break}}else{shim=-t.getWidth()/2}var val=this.u2p(t.value)+shim+"px";t._elem.css("left",val);t.pack()}}var labeledge=["bottom",0];if(lshow){var w=this._label._elem.outerWidth(true);this._label._elem.css("left",offmin+pixellength/2-w/2+"px");if(this.name=="xaxis"){this._label._elem.css("bottom","0px");labeledge=["bottom",this._label._elem.outerHeight(true)]}else{this._label._elem.css("top","0px");labeledge=["top",this._label._elem.outerHeight(true)]}this._label.pack()}var step=parseInt(this._ticks.length/this.groups,10);for(i=0;i<this._groupLabels.length;i++){var mid=0;var count=0;for(var j=i*step;j<=(i+1)*step;j++){if(this._ticks[j]._elem&&this._ticks[j].label!=" "){var t=this._ticks[j]._elem;var p=t.position();mid+=p.left+t.outerWidth(true)/2;count++}}mid=mid/count;this._groupLabels[i].css({left:(mid-this._groupLabels[i].outerWidth(true)/2)});this._groupLabels[i].css(labeledge[0],labeledge[1])}}else{for(i=0;i<ticks.length;i++){var t=ticks[i];if(t.show&&t.showLabel){var shim;if(t.constructor==$.jqplot.CanvasAxisTickRenderer&&t.angle){var temp=(this.name=="yaxis")?1:-1;switch(t.labelPosition){case"auto":case"end":if(temp*t.angle<0){shim=-t._textRenderer.height*Math.cos(-t._textRenderer.angle)/2}else{shim=-t.getHeight()+t._textRenderer.height*Math.cos(t._textRenderer.angle)/2}break;case"start":if(t.angle>0){shim=-t._textRenderer.height*Math.cos(-t._textRenderer.angle)/2}else{shim=-t.getHeight()+t._textRenderer.height*Math.cos(t._textRenderer.angle)/2}break;case"middle":shim=-t.getHeight()/2;break;default:shim=-t.getHeight()/2;break}}else{shim=-t.getHeight()/2}var val=this.u2p(t.value)+shim+"px";t._elem.css("top",val);t.pack()}}var labeledge=["left",0];if(lshow){var h=this._label._elem.outerHeight(true);this._label._elem.css("top",offmax-pixellength/2-h/2+"px");if(this.name=="yaxis"){this._label._elem.css("left","0px");labeledge=["left",this._label._elem.outerWidth(true)]}else{this._label._elem.css("right","0px");labeledge=["right",this._label._elem.outerWidth(true)]}this._label.pack()}var step=parseInt(this._ticks.length/this.groups,10);for(i=0;i<this._groupLabels.length;i++){var mid=0;var count=0;for(var j=i*step;j<=(i+1)*step;j++){if(this._ticks[j]._elem&&this._ticks[j].label!=" "){var t=this._ticks[j]._elem;var p=t.position();mid+=p.top+t.outerHeight()/2;count++}}mid=mid/count;this._groupLabels[i].css({top:mid-this._groupLabels[i].outerHeight()/2});this._groupLabels[i].css(labeledge[0],labeledge[1])}}}}})(jQuery);(function($){$.jqplot.PieRenderer=function(){$.jqplot.LineRenderer.call(this)};$.jqplot.PieRenderer.prototype=new $.jqplot.LineRenderer();$.jqplot.PieRenderer.prototype.constructor=$.jqplot.PieRenderer;$.jqplot.PieRenderer.prototype.init=function(options,plot){this.diameter=null;this.padding=20;this.sliceMargin=0;this.fill=true;this.shadowOffset=2;this.shadowAlpha=0.07;this.shadowDepth=5;this.highlightMouseOver=true;this.highlightMouseDown=false;this.highlightColors=[];this.dataLabels="percent";this.showDataLabels=false;this.dataLabelFormatString=null;this.dataLabelThreshold=3;this.dataLabelPositionFactor=0.52;this.dataLabelNudge=2;this.dataLabelCenterOn=true;this.startAngle=0;this.tickRenderer=$.jqplot.PieTickRenderer;this._drawData=true;if(options.highlightMouseDown&&options.highlightMouseOver==null){options.highlightMouseOver=false}$.extend(true,this,options);if(this.diameter!=null){this.diameter=this.diameter-this.sliceMargin}this._diameter=null;this._radius=null;this._sliceAngles=[];this._highlightedPoint=null;if(this.highlightColors.length==0){for(var i=0;i<this.seriesColors.length;i++){var rgba=$.jqplot.getColorComponents(this.seriesColors[i]);var newrgb=[rgba[0],rgba[1],rgba[2]];var sum=newrgb[0]+newrgb[1]+newrgb[2];for(var j=0;j<3;j++){newrgb[j]=(sum>570)?newrgb[j]*0.8:newrgb[j]+0.3*(255-newrgb[j]);newrgb[j]=parseInt(newrgb[j],10)}this.highlightColors.push("rgb("+newrgb[0]+","+newrgb[1]+","+newrgb[2]+")")}}this.highlightColorGenerator=new $.jqplot.ColorGenerator(this.highlightColors);plot.postParseOptionsHooks.addOnce(postParseOptions);plot.postInitHooks.addOnce(postInit);plot.eventListenerHooks.addOnce("jqplotMouseMove",handleMove);plot.eventListenerHooks.addOnce("jqplotMouseDown",handleMouseDown);plot.eventListenerHooks.addOnce("jqplotMouseUp",handleMouseUp);plot.eventListenerHooks.addOnce("jqplotClick",handleClick);plot.eventListenerHooks.addOnce("jqplotRightClick",handleRightClick);plot.postDrawHooks.addOnce(postPlotDraw)};$.jqplot.PieRenderer.prototype.setGridData=function(plot){var stack=[];var td=[];var sa=this.startAngle/180*Math.PI;var tot=0;this._drawData=false;for(var i=0;i<this.data.length;i++){if(this.data[i][1]!=0){this._drawData=true}stack.push(this.data[i][1]);td.push([this.data[i][0]]);if(i>0){stack[i]+=stack[i-1]}tot+=this.data[i][1]}var fact=Math.PI*2/stack[stack.length-1];for(var i=0;i<stack.length;i++){td[i][1]=stack[i]*fact;td[i][2]=this.data[i][1]/tot}this.gridData=td};$.jqplot.PieRenderer.prototype.makeGridData=function(data,plot){var stack=[];var td=[];var tot=0;var sa=this.startAngle/180*Math.PI;this._drawData=false;for(var i=0;i<data.length;i++){if(this.data[i][1]!=0){this._drawData=true}stack.push(data[i][1]);td.push([data[i][0]]);if(i>0){stack[i]+=stack[i-1]}tot+=data[i][1]}var fact=Math.PI*2/stack[stack.length-1];for(var i=0;i<stack.length;i++){td[i][1]=stack[i]*fact;td[i][2]=data[i][1]/tot}return td};$.jqplot.PieRenderer.prototype.drawSlice=function(ctx,ang1,ang2,color,isShadow){if(this._drawData){var r=this._diameter/2;var fill=this.fill;var lineWidth=this.lineWidth;ctx.save();ctx.translate(this._center[0],this._center[1]);ctx.translate(this.sliceMargin*Math.cos((ang1+ang2)/2),this.sliceMargin*Math.sin((ang1+ang2)/2));if(isShadow){for(var i=0;i<this.shadowDepth;i++){ctx.save();ctx.translate(this.shadowOffset*Math.cos(this.shadowAngle/180*Math.PI),this.shadowOffset*Math.sin(this.shadowAngle/180*Math.PI));doDraw()}}else{doDraw()}}function doDraw(){if(ang2>6.282+this.startAngle){ang2=6.282+this.startAngle;if(ang1>ang2){ang1=6.281+this.startAngle}}if(ang1>=ang2){return}ctx.beginPath();ctx.fillStyle=color;ctx.strokeStyle=color;ctx.lineWidth=lineWidth;ctx.arc(0,0,r,ang1,ang2,false);ctx.lineTo(0,0);ctx.closePath();if(fill){ctx.fill()}else{ctx.stroke()}}if(isShadow){for(var i=0;i<this.shadowDepth;i++){ctx.restore()}}ctx.restore()};$.jqplot.PieRenderer.prototype.draw=function(ctx,gd,options,plot){var i;var opts=(options!=undefined)?options:{};var offx=0;var offy=0;var trans=1;var colorGenerator=new $.jqplot.ColorGenerator(this.seriesColors);if(options.legendInfo&&options.legendInfo.placement=="insideGrid"){var li=options.legendInfo;switch(li.location){case"nw":offx=li.width+li.xoffset;break;case"w":offx=li.width+li.xoffset;break;case"sw":offx=li.width+li.xoffset;break;case"ne":offx=li.width+li.xoffset;trans=-1;break;case"e":offx=li.width+li.xoffset;trans=-1;break;case"se":offx=li.width+li.xoffset;trans=-1;break;case"n":offy=li.height+li.yoffset;break;case"s":offy=li.height+li.yoffset;trans=-1;break;default:break}}var shadow=(opts.shadow!=undefined)?opts.shadow:this.shadow;var showLine=(opts.showLine!=undefined)?opts.showLine:this.showLine;var fill=(opts.fill!=undefined)?opts.fill:this.fill;var cw=ctx.canvas.width;var ch=ctx.canvas.height;var w=cw-offx-2*this.padding;var h=ch-offy-2*this.padding;var mindim=Math.min(w,h);var d=mindim;this._diameter=this.diameter||d-this.sliceMargin;var r=this._radius=this._diameter/2;var sa=this.startAngle/180*Math.PI;this._center=[(cw-trans*offx)/2+trans*offx,(ch-trans*offy)/2+trans*offy];if(this.shadow){var shadowColor="rgba(0,0,0,"+this.shadowAlpha+")";for(var i=0;i<gd.length;i++){var ang1=(i==0)?sa:gd[i-1][1]+sa;ang1+=this.sliceMargin/180*Math.PI;this.renderer.drawSlice.call(this,ctx,ang1,gd[i][1]+sa,shadowColor,true)}}for(var i=0;i<gd.length;i++){var ang1=(i==0)?sa:gd[i-1][1]+sa;ang1+=this.sliceMargin/180*Math.PI;var ang2=gd[i][1]+sa;this._sliceAngles.push([ang1,ang2]);this.renderer.drawSlice.call(this,ctx,ang1,ang2,colorGenerator.next(),false);if(this.showDataLabels&&gd[i][2]*100>=this.dataLabelThreshold){var fstr,avgang=(ang1+ang2)/2,label;if(this.dataLabels=="label"){fstr=this.dataLabelFormatString||"%s";label=$.jqplot.sprintf(fstr,gd[i][0])}else{if(this.dataLabels=="value"){fstr=this.dataLabelFormatString||"%d";label=$.jqplot.sprintf(fstr,this.data[i][1])}else{if(this.dataLabels=="percent"){fstr=this.dataLabelFormatString||"%d%%";label=$.jqplot.sprintf(fstr,gd[i][2]*100)}else{if(this.dataLabels.constructor==Array){fstr=this.dataLabelFormatString||"%s";label=$.jqplot.sprintf(fstr,this.dataLabels[i])}}}}var fact=(this._radius)*this.dataLabelPositionFactor+this.sliceMargin+this.dataLabelNudge;var x=this._center[0]+Math.cos(avgang)*fact+this.canvas._offsets.left;var y=this._center[1]+Math.sin(avgang)*fact+this.canvas._offsets.top;var labelelem=$('<div class="jqplot-pie-series jqplot-data-label" style="position:absolute;">'+label+"</div>").insertBefore(plot.eventCanvas._elem);if(this.dataLabelCenterOn){x-=labelelem.width()/2;y-=labelelem.height()/2}else{x-=labelelem.width()*Math.sin(avgang/2);y-=labelelem.height()/2}x=Math.round(x);y=Math.round(y);labelelem.css({left:x,top:y})}}};$.jqplot.PieAxisRenderer=function(){$.jqplot.LinearAxisRenderer.call(this)};$.jqplot.PieAxisRenderer.prototype=new $.jqplot.LinearAxisRenderer();$.jqplot.PieAxisRenderer.prototype.constructor=$.jqplot.PieAxisRenderer;$.jqplot.PieAxisRenderer.prototype.init=function(options){this.tickRenderer=$.jqplot.PieTickRenderer;$.extend(true,this,options);this._dataBounds={min:0,max:100};this.min=0;this.max=100;this.showTicks=false;this.ticks=[];this.showMark=false;this.show=false};$.jqplot.PieLegendRenderer=function(){$.jqplot.TableLegendRenderer.call(this)};$.jqplot.PieLegendRenderer.prototype=new $.jqplot.TableLegendRenderer();$.jqplot.PieLegendRenderer.prototype.constructor=$.jqplot.PieLegendRenderer;$.jqplot.PieLegendRenderer.prototype.init=function(options){this.numberRows=null;this.numberColumns=null;$.extend(true,this,options)};$.jqplot.PieLegendRenderer.prototype.draw=function(){var legend=this;if(this.show){var series=this._series;var ss="position:absolute;";ss+=(this.background)?"background:"+this.background+";":"";ss+=(this.border)?"border:"+this.border+";":"";ss+=(this.fontSize)?"font-size:"+this.fontSize+";":"";ss+=(this.fontFamily)?"font-family:"+this.fontFamily+";":"";ss+=(this.textColor)?"color:"+this.textColor+";":"";ss+=(this.marginTop!=null)?"margin-top:"+this.marginTop+";":"";ss+=(this.marginBottom!=null)?"margin-bottom:"+this.marginBottom+";":"";ss+=(this.marginLeft!=null)?"margin-left:"+this.marginLeft+";":"";ss+=(this.marginRight!=null)?"margin-right:"+this.marginRight+";":"";this._elem=$('<table class="jqplot-table-legend" style="'+ss+'"></table>');var pad=false,reverse=false,nr,nc;var s=series[0];var colorGenerator=new $.jqplot.ColorGenerator(s.seriesColors);if(s.show){var pd=s.data;if(this.numberRows){nr=this.numberRows;if(!this.numberColumns){nc=Math.ceil(pd.length/nr)}else{nc=this.numberColumns}}else{if(this.numberColumns){nc=this.numberColumns;nr=Math.ceil(pd.length/this.numberColumns)}else{nr=pd.length;nc=1}}var i,j,tr,td1,td2,lt,rs,color;var idx=0;for(i=0;i<nr;i++){if(reverse){tr=$('<tr class="jqplot-table-legend"></tr>').prependTo(this._elem)}else{tr=$('<tr class="jqplot-table-legend"></tr>').appendTo(this._elem)}for(j=0;j<nc;j++){if(idx<pd.length){lt=this.labels[idx]||pd[idx][0].toString();color=colorGenerator.next();if(!reverse){if(i>0){pad=true}else{pad=false}}else{if(i==nr-1){pad=false}else{pad=true}}rs=(pad)?this.rowSpacing:"0";td1=$('<td class="jqplot-table-legend" style="text-align:center;padding-top:'+rs+';"><div><div class="jqplot-table-legend-swatch" style="border-color:'+color+';"></div></div></td>');td2=$('<td class="jqplot-table-legend" style="padding-top:'+rs+';"></td>');if(this.escapeHtml){td2.text(lt)}else{td2.html(lt)}if(reverse){td2.prependTo(tr);td1.prependTo(tr)}else{td1.appendTo(tr);td2.appendTo(tr)}pad=true}idx++}}}}return this._elem};$.jqplot.PieRenderer.prototype.handleMove=function(ev,gridpos,datapos,neighbor,plot){if(neighbor){var ins=[neighbor.seriesIndex,neighbor.pointIndex,neighbor.data];plot.target.trigger("jqplotDataMouseOver",ins);if(plot.series[ins[0]].highlightMouseOver&&!(ins[0]==plot.plugins.pieRenderer.highlightedSeriesIndex&&ins[1]==plot.series[ins[0]]._highlightedPoint)){plot.target.trigger("jqplotDataHighlight",ins);highlight(plot,ins[0],ins[1])}}else{if(neighbor==null){unhighlight(plot)}}};function preInit(target,data,options){options=options||{};options.axesDefaults=options.axesDefaults||{};options.legend=options.legend||{};options.seriesDefaults=options.seriesDefaults||{};var setopts=false;if(options.seriesDefaults.renderer==$.jqplot.PieRenderer){setopts=true}else{if(options.series){for(var i=0;i<options.series.length;i++){if(options.series[i].renderer==$.jqplot.PieRenderer){setopts=true}}}}if(setopts){options.axesDefaults.renderer=$.jqplot.PieAxisRenderer;options.legend.renderer=$.jqplot.PieLegendRenderer;options.legend.preDraw=true;options.seriesDefaults.pointLabels={show:false}}}function postInit(target,data,options){for(i=0;i<this.series.length;i++){if(this.series[i].renderer.constructor==$.jqplot.PieRenderer){if(this.series[i].highlightMouseOver){this.series[i].highlightMouseDown=false}}}this.target.bind("mouseout",{plot:this},function(ev){unhighlight(ev.data.plot)})}function postParseOptions(options){for(var i=0;i<this.series.length;i++){this.series[i].seriesColors=this.seriesColors;this.series[i].colorGenerator=this.colorGenerator}}function highlight(plot,sidx,pidx){var s=plot.series[sidx];var canvas=plot.plugins.pieRenderer.highlightCanvas;canvas._ctx.clearRect(0,0,canvas._ctx.canvas.width,canvas._ctx.canvas.height);s._highlightedPoint=pidx;plot.plugins.pieRenderer.highlightedSeriesIndex=sidx;s.renderer.drawSlice.call(s,canvas._ctx,s._sliceAngles[pidx][0],s._sliceAngles[pidx][1],s.highlightColorGenerator.get(pidx),false)}function unhighlight(plot){var canvas=plot.plugins.pieRenderer.highlightCanvas;canvas._ctx.clearRect(0,0,canvas._ctx.canvas.width,canvas._ctx.canvas.height);for(var i=0;i<plot.series.length;i++){plot.series[i]._highlightedPoint=null}plot.plugins.pieRenderer.highlightedSeriesIndex=null;plot.target.trigger("jqplotDataUnhighlight")}function handleMove(ev,gridpos,datapos,neighbor,plot){if(neighbor){var ins=[neighbor.seriesIndex,neighbor.pointIndex,neighbor.data];var evt1=jQuery.Event("jqplotDataMouseOver");evt1.pageX=ev.pageX;evt1.pageY=ev.pageY;plot.target.trigger(evt1,ins);if(plot.series[ins[0]].highlightMouseOver&&!(ins[0]==plot.plugins.pieRenderer.highlightedSeriesIndex&&ins[1]==plot.series[ins[0]]._highlightedPoint)){var evt=jQuery.Event("jqplotDataHighlight");evt.pageX=ev.pageX;evt.pageY=ev.pageY;plot.target.trigger(evt,ins);highlight(plot,ins[0],ins[1])}}else{if(neighbor==null){unhighlight(plot)}}}function handleMouseDown(ev,gridpos,datapos,neighbor,plot){if(neighbor){var ins=[neighbor.seriesIndex,neighbor.pointIndex,neighbor.data];if(plot.series[ins[0]].highlightMouseDown&&!(ins[0]==plot.plugins.pieRenderer.highlightedSeriesIndex&&ins[1]==plot.series[ins[0]]._highlightedPoint)){var evt=jQuery.Event("jqplotDataHighlight");evt.pageX=ev.pageX;evt.pageY=ev.pageY;plot.target.trigger(evt,ins);highlight(plot,ins[0],ins[1])}}else{if(neighbor==null){unhighlight(plot)}}}function handleMouseUp(ev,gridpos,datapos,neighbor,plot){var idx=plot.plugins.pieRenderer.highlightedSeriesIndex;if(idx!=null&&plot.series[idx].highlightMouseDown){unhighlight(plot)}}function handleClick(ev,gridpos,datapos,neighbor,plot){if(neighbor){var ins=[neighbor.seriesIndex,neighbor.pointIndex,neighbor.data];var evt=jQuery.Event("jqplotDataClick");evt.pageX=ev.pageX;evt.pageY=ev.pageY;plot.target.trigger(evt,ins)}}function handleRightClick(ev,gridpos,datapos,neighbor,plot){if(neighbor){var ins=[neighbor.seriesIndex,neighbor.pointIndex,neighbor.data];var idx=plot.plugins.pieRenderer.highlightedSeriesIndex;if(idx!=null&&plot.series[idx].highlightMouseDown){unhighlight(plot)}var evt=jQuery.Event("jqplotDataRightClick");evt.pageX=ev.pageX;evt.pageY=ev.pageY;plot.target.trigger(evt,ins)}}function postPlotDraw(){this.plugins.pieRenderer={highlightedSeriesIndex:null};this.plugins.pieRenderer.highlightCanvas=new $.jqplot.GenericCanvas();var labels=$(this.targetId+" .jqplot-data-label");if(labels.length){$(labels[0]).before(this.plugins.pieRenderer.highlightCanvas.createElement(this._gridPadding,"jqplot-pieRenderer-highlight-canvas",this._plotDimensions))}else{this.eventCanvas._elem.before(this.plugins.pieRenderer.highlightCanvas.createElement(this._gridPadding,"jqplot-pieRenderer-highlight-canvas",this._plotDimensions))}var hctx=this.plugins.pieRenderer.highlightCanvas.setContext()}$.jqplot.preInitHooks.push(preInit);$.jqplot.PieTickRenderer=function(){$.jqplot.AxisTickRenderer.call(this)};$.jqplot.PieTickRenderer.prototype=new $.jqplot.AxisTickRenderer();$.jqplot.PieTickRenderer.prototype.constructor=$.jqplot.PieTickRenderer})(jQuery);(function($){$.jqplot.eventListenerHooks.push(["jqplotMouseMove",handleMove]);$.jqplot.Highlighter=function(options){this.show=$.jqplot.config.enablePlugins;this.markerRenderer=new $.jqplot.MarkerRenderer({shadow:false});this.showMarker=true;this.lineWidthAdjust=2.5;this.sizeAdjust=5;this.showTooltip=true;this.tooltipLocation="nw";this.fadeTooltip=true;this.tooltipFadeSpeed="fast";this.tooltipOffset=2;this.tooltipAxes="both";this.tooltipSeparator=", ";this.useAxesFormatters=true;this.tooltipFormatString="%.5P";this.formatString=null;this.yvalues=1;this.bringSeriesToFront=false;this._tooltipElem;this.isHighlighting=false;$.extend(true,this,options)};$.jqplot.Highlighter.init=function(target,data,opts){var options=opts||{};this.plugins.highlighter=new $.jqplot.Highlighter(options.highlighter)};$.jqplot.Highlighter.parseOptions=function(defaults,options){this.showHighlight=true};$.jqplot.Highlighter.postPlotDraw=function(){this.plugins.highlighter.highlightCanvas=new $.jqplot.GenericCanvas();this.eventCanvas._elem.before(this.plugins.highlighter.highlightCanvas.createElement(this._gridPadding,"jqplot-highlight-canvas",this._plotDimensions));var hctx=this.plugins.highlighter.highlightCanvas.setContext();var p=this.plugins.highlighter;p._tooltipElem=$('<div class="jqplot-highlighter-tooltip" style="position:absolute;display:none"></div>');this.eventCanvas._elem.before(p._tooltipElem)};$.jqplot.preInitHooks.push($.jqplot.Highlighter.init);$.jqplot.preParseSeriesOptionsHooks.push($.jqplot.Highlighter.parseOptions);$.jqplot.postDrawHooks.push($.jqplot.Highlighter.postPlotDraw);function draw(plot,neighbor){var hl=plot.plugins.highlighter;var s=plot.series[neighbor.seriesIndex];var smr=s.markerRenderer;var mr=hl.markerRenderer;mr.style=smr.style;mr.lineWidth=smr.lineWidth+hl.lineWidthAdjust;mr.size=smr.size+hl.sizeAdjust;var rgba=$.jqplot.getColorComponents(smr.color);var newrgb=[rgba[0],rgba[1],rgba[2]];var alpha=(rgba[3]>=0.6)?rgba[3]*0.6:rgba[3]*(2-rgba[3]);mr.color="rgba("+newrgb[0]+","+newrgb[1]+","+newrgb[2]+","+alpha+")";mr.init();mr.draw(s.gridData[neighbor.pointIndex][0],s.gridData[neighbor.pointIndex][1],hl.highlightCanvas._ctx)}function showTooltip(plot,series,neighbor){var hl=plot.plugins.highlighter;var elem=hl._tooltipElem;if(hl.useAxesFormatters){var xf=series._xaxis._ticks[0].formatter;var yf=series._yaxis._ticks[0].formatter;var xfstr=series._xaxis._ticks[0].formatString;var yfstr=series._yaxis._ticks[0].formatString;var str;var xstr=xf(xfstr,neighbor.data[0]);var ystrs=[];for(var i=1;i<hl.yvalues+1;i++){ystrs.push(yf(yfstr,neighbor.data[i]))}if(hl.formatString){switch(hl.tooltipAxes){case"both":case"xy":ystrs.unshift(xstr);ystrs.unshift(hl.formatString);str=$.jqplot.sprintf.apply($.jqplot.sprintf,ystrs);break;case"yx":ystrs.push(xstr);ystrs.unshift(hl.formatString);str=$.jqplot.sprintf.apply($.jqplot.sprintf,ystrs);break;case"x":str=$.jqplot.sprintf.apply($.jqplot.sprintf,[hl.formatString,xstr]);break;case"y":ystrs.unshift(hl.formatString);str=$.jqplot.sprintf.apply($.jqplot.sprintf,ystrs);break;default:ystrs.unshift(xstr);ystrs.unshift(hl.formatString);str=$.jqplot.sprintf.apply($.jqplot.sprintf,ystrs);break}}else{switch(hl.tooltipAxes){case"both":case"xy":str=xstr;for(var i=0;i<ystrs.length;i++){str+=hl.tooltipSeparator+ystrs[i]}break;case"yx":str="";for(var i=0;i<ystrs.length;i++){str+=ystrs[i]+hl.tooltipSeparator}str+=xstr;break;case"x":str=xstr;break;case"y":str="";for(var i=0;i<ystrs.length;i++){str+=ystrs[i]+hl.tooltipSeparator}break;default:str=xstr;for(var i=0;i<ystrs.length;i++){str+=hl.tooltipSeparator+ystrs[i]}break}}}else{var str;if(hl.tooltipAxes=="both"||hl.tooltipAxes=="xy"){str=$.jqplot.sprintf(hl.tooltipFormatString,neighbor.data[0])+hl.tooltipSeparator+$.jqplot.sprintf(hl.tooltipFormatString,neighbor.data[1])}else{if(hl.tooltipAxes=="yx"){str=$.jqplot.sprintf(hl.tooltipFormatString,neighbor.data[1])+hl.tooltipSeparator+$.jqplot.sprintf(hl.tooltipFormatString,neighbor.data[0])}else{if(hl.tooltipAxes=="x"){str=$.jqplot.sprintf(hl.tooltipFormatString,neighbor.data[0])}else{if(hl.tooltipAxes=="y"){str=$.jqplot.sprintf(hl.tooltipFormatString,neighbor.data[1])}}}}}elem.html(str);var gridpos={x:neighbor.gridData[0],y:neighbor.gridData[1]};var ms=0;var fact=0.707;if(series.markerRenderer.show==true){ms=(series.markerRenderer.size+hl.sizeAdjust)/2}switch(hl.tooltipLocation){case"nw":var x=gridpos.x+plot._gridPadding.left-elem.outerWidth(true)-hl.tooltipOffset-fact*ms;var y=gridpos.y+plot._gridPadding.top-hl.tooltipOffset-elem.outerHeight(true)-fact*ms;break;case"n":var x=gridpos.x+plot._gridPadding.left-elem.outerWidth(true)/2;var y=gridpos.y+plot._gridPadding.top-hl.tooltipOffset-elem.outerHeight(true)-ms;break;case"ne":var x=gridpos.x+plot._gridPadding.left+hl.tooltipOffset+fact*ms;var y=gridpos.y+plot._gridPadding.top-hl.tooltipOffset-elem.outerHeight(true)-fact*ms;break;case"e":var x=gridpos.x+plot._gridPadding.left+hl.tooltipOffset+ms;var y=gridpos.y+plot._gridPadding.top-elem.outerHeight(true)/2;break;case"se":var x=gridpos.x+plot._gridPadding.left+hl.tooltipOffset+fact*ms;var y=gridpos.y+plot._gridPadding.top+hl.tooltipOffset+fact*ms;break;case"s":var x=gridpos.x+plot._gridPadding.left-elem.outerWidth(true)/2;var y=gridpos.y+plot._gridPadding.top+hl.tooltipOffset+ms;break;case"sw":var x=gridpos.x+plot._gridPadding.left-elem.outerWidth(true)-hl.tooltipOffset-fact*ms;var y=gridpos.y+plot._gridPadding.top+hl.tooltipOffset+fact*ms;break;case"w":var x=gridpos.x+plot._gridPadding.left-elem.outerWidth(true)-hl.tooltipOffset-ms;var y=gridpos.y+plot._gridPadding.top-elem.outerHeight(true)/2;break;default:var x=gridpos.x+plot._gridPadding.left-elem.outerWidth(true)-hl.tooltipOffset-fact*ms;var y=gridpos.y+plot._gridPadding.top-hl.tooltipOffset-elem.outerHeight(true)-fact*ms;break}elem.css("left",x);elem.css("top",y);if(hl.fadeTooltip){elem.stop(true,true).fadeIn(hl.tooltipFadeSpeed)}else{elem.show()}}function handleMove(ev,gridpos,datapos,neighbor,plot){var hl=plot.plugins.highlighter;var c=plot.plugins.cursor;if(hl.show){if(neighbor==null&&hl.isHighlighting){var ctx=hl.highlightCanvas._ctx;ctx.clearRect(0,0,ctx.canvas.width,ctx.canvas.height);if(hl.fadeTooltip){hl._tooltipElem.fadeOut(hl.tooltipFadeSpeed)}else{hl._tooltipElem.hide()}if(hl.bringSeriesToFront){plot.restorePreviousSeriesOrder()}hl.isHighlighting=false}if(neighbor!=null&&plot.series[neighbor.seriesIndex].showHighlight&&!hl.isHighlighting){hl.isHighlighting=true;if(hl.showMarker){draw(plot,neighbor)}if(hl.showTooltip&&(!c||!c._zoom.started)){showTooltip(plot,plot.series[neighbor.seriesIndex],neighbor)}if(hl.bringSeriesToFront){plot.moveSeriesToFront(neighbor.seriesIndex)}}}}})(jQuery);(function($){$.jqplot.PointLabels=function(options){this.show=$.jqplot.config.enablePlugins;this.location="n";this.labelsFromSeries=false;this.seriesLabelIndex=null;this.labels=[];this._labels=[];this.stackedValue=false;this.ypadding=6;this.xpadding=6;this.escapeHTML=true;this.edgeTolerance=-5;this.formatter=$.jqplot.DefaultTickFormatter;this.formatString="";this.hideZeros=false;this._elems=[];$.extend(true,this,options)};var locations=["nw","n","ne","e","se","s","sw","w"];var locationIndicies={nw:0,n:1,ne:2,e:3,se:4,s:5,sw:6,w:7};var oppositeLocations=["se","s","sw","w","nw","n","ne","e"];$.jqplot.PointLabels.init=function(target,data,seriesDefaults,opts){var options=$.extend(true,{},seriesDefaults,opts);options.pointLabels=options.pointLabels||{};if(this.renderer.constructor==$.jqplot.BarRenderer&&this.barDirection=="horizontal"&&!options.pointLabels.location){options.pointLabels.location="e"}this.plugins.pointLabels=new $.jqplot.PointLabels(options.pointLabels);this.plugins.pointLabels.setLabels.call(this)};$.jqplot.PointLabels.prototype.setLabels=function(){var p=this.plugins.pointLabels;var labelIdx;if(p.seriesLabelIndex!=null){labelIdx=p.seriesLabelIndex}else{if(this.renderer.constructor==$.jqplot.BarRenderer&&this.barDirection=="horizontal"){labelIdx=0}else{labelIdx=this._plotData[0].length-1}}p._labels=[];if(p.labels.length==0||p.labelsFromSeries){if(p.stackedValue){if(this._plotData.length&&this._plotData[0].length){for(var i=0;i<this._plotData.length;i++){p._labels.push(this._plotData[i][labelIdx])}}}else{var d=this.data;if(this.renderer.constructor==$.jqplot.BarRenderer&&this.waterfall){d=this._data}if(d.length&&d[0].length){for(var i=0;i<d.length;i++){p._labels.push(d[i][labelIdx])}}}}else{if(p.labels.length){p._labels=p.labels}}};$.jqplot.PointLabels.prototype.xOffset=function(elem,location,padding){location=location||this.location;padding=padding||this.xpadding;var offset;switch(location){case"nw":offset=-elem.outerWidth(true)-this.xpadding;break;case"n":offset=-elem.outerWidth(true)/2;break;case"ne":offset=this.xpadding;break;case"e":offset=this.xpadding;break;case"se":offset=this.xpadding;break;case"s":offset=-elem.outerWidth(true)/2;break;case"sw":offset=-elem.outerWidth(true)-this.xpadding;break;case"w":offset=-elem.outerWidth(true)-this.xpadding;break;default:offset=-elem.outerWidth(true)-this.xpadding;break}return offset};$.jqplot.PointLabels.prototype.yOffset=function(elem,location,padding){location=location||this.location;padding=padding||this.xpadding;var offset;switch(location){case"nw":offset=-elem.outerHeight(true)-this.ypadding;break;case"n":offset=-elem.outerHeight(true)-this.ypadding;break;case"ne":offset=-elem.outerHeight(true)-this.ypadding;break;case"e":offset=-elem.outerHeight(true)/2;break;case"se":offset=this.ypadding;break;case"s":offset=this.ypadding;break;case"sw":offset=this.ypadding;break;case"w":offset=-elem.outerHeight(true)/2;break;default:offset=-elem.outerHeight(true)-this.ypadding;break}return offset};$.jqplot.PointLabels.draw=function(sctx,options){var p=this.plugins.pointLabels;p.setLabels.call(this);for(var i=0;i<p._elems.length;i++){p._elems[i].remove()}if(p.show){var ax="_"+this._stackAxis+"axis";if(!p.formatString){p.formatString=this[ax]._ticks[0].formatString;p.formatter=this[ax]._ticks[0].formatter}var pd=this._plotData;var xax=this._xaxis;var yax=this._yaxis;for(var i=p._labels.length-1;i>=0;i--){var label=p._labels[i];if(p.hideZeros&&parseInt(p._labels[i],10)==0){label=""}if(label!=null){label=p.formatter(p.formatString,label)}var elem=$('<div class="jqplot-point-label jqplot-series-'+this.index+" jqplot-point-"+i+'" style="position:absolute"></div>');elem.insertAfter(sctx.canvas);p._elems.push(elem);if(p.escapeHTML){elem.text(label)}else{elem.html(label)}var location=p.location;if(this.waterfall&&parseInt(label,10)<0){location=oppositeLocations[locationIndicies[location]]}var ell=xax.u2p(pd[i][0])+p.xOffset(elem,location);var elt=yax.u2p(pd[i][1])+p.yOffset(elem,location);if(this.renderer.constructor==$.jqplot.BarRenderer){if(this.barDirection=="vertical"){ell+=this._barNudge}else{elt-=this._barNudge}}elem.css("left",ell);elem.css("top",elt);var elr=ell+$(elem).width();var elb=elt+$(elem).height();var et=p.edgeTolerance;var scl=$(sctx.canvas).position().left;var sct=$(sctx.canvas).position().top;var scr=sctx.canvas.width+scl;var scb=sctx.canvas.height+sct;if(ell-et<scl||elt-et<sct||elr+et>scr||elb+et>scb){$(elem).detach()}}}};$.jqplot.postSeriesInitHooks.push($.jqplot.PointLabels.init);$.jqplot.postDrawSeriesHooks.push($.jqplot.PointLabels.draw)})(jQuery);jQuery.fn.center=function(params){var options={vertical:true,horizontal:true};var op=jQuery.extend(options,params);return this.each(function(){var $self=jQuery(this);var width=$self.width();var height=$self.height();var paddingTop=parseInt($self.css("padding-top"));var paddingBottom=parseInt($self.css("padding-bottom"));var borderTop=parseInt($self.css("border-top-width"))||0;var borderBottom=parseInt($self.css("border-bottom-width"))||0;var mediaBorder=(borderTop+borderBottom)/2;var mediaPadding=(paddingTop+paddingBottom)/2;var positionType=$self.parent().css("position");var halfWidth=(width/2)*(-1);var halfHeight=((height/2)*(-1))-mediaPadding-mediaBorder;var cssProp={position:"absolute"};if(op.vertical){cssProp.height=height;cssProp.top="50%";cssProp.marginTop=halfHeight}if(op.horizontal){cssProp.width=width;cssProp.left="50%";cssProp.marginLeft=halfWidth}if(positionType=="static"){$self.parent().css("position","relative")}$self.css(cssProp)})};Date.prototype.format=function(format){var o={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};if(/(y+)/.test(format)){format=format.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length))}for(var k in o){if(new RegExp("("+k+")").test(format)){format=format.replace(RegExp.$1,RegExp.$1.length==1?o[k]:("00"+o[k]).substr((""+o[k]).length))}}return format};Number.prototype.format=function(pattern){var strarr=this.toString().split(".");var fmtarr=pattern?pattern.split("."):[""];var retstr="";var str=strarr[0];var fmt=fmtarr[0];var i=str.length-1;var comma=false;for(var f=fmt.length-1;f>=0;f--){switch(fmt.substr(f,1)){case"#":if(i>=0){retstr=str.substr(i--,1)+retstr}break;case"0":if(i>=0){retstr=str.substr(i--,1)+retstr}else{retstr="0"+retstr}break;case",":comma=true;retstr=","+retstr;break}}if(i>=0){if(comma){var l=str.length;for(;i>=0;i--){retstr=str.substr(i,1)+retstr;if(i>0&&((l-i)%3)==0){retstr=","+retstr}}}else{retstr=str.substr(0,i+1)+retstr}}retstr=retstr+".";str=strarr.length>1?strarr[1]:"";fmt=fmtarr.length>1?fmtarr[1]:"";i=0;for(var f=0;f<fmt.length;f++){switch(fmt.substr(f,1)){case"#":if(i<str.length){retstr+=str.substr(i++,1)}break;case"0":if(i<str.length){retstr+=str.substr(i++,1)}else{retstr+="0"}break}}return retstr.replace(/^,+/,"").replace(/\.$/,"")};Number.format=function(num,pattern){num=Number(num);return num.format(pattern)};Number.prototype.toLessArray=function(){var arr=[],i=0;do{arr.push(i)}while(++i<this);return arr};Number.toLessArray=function(num){return Number(num).toLessArray()};Number.getMaxMin=function(array){var max=0,min=0,len=array.length;if(len>0){min=array[0];for(var i=0;i<len;i++){if(array[i]>max){max=array[i]}else{if(array[i]<min){min=array[i]}}}}return{max:max,min:min}};String.prototype.format=function(){var args=arguments;return this.replace(/\{(\d+)\}/g,function(m,i){return args[i]})};String.format=function(){if(arguments.length==0){return null}var str=arguments[0];for(var i=1;i<arguments.length;i++){var re=new RegExp("\\{"+(i-1)+"\\}","gm");str=str.replace(re,arguments[i])}return str};function Rect(x,y,w,h,data){this.getX1=function(){return x};this.getY1=function(){return y};this.setX1=function(newX){x=newX};this.setY1=function(newY){y=newY};this.getWidth=function(){return w};this.getHeight=function(){return h};this.getX2=function(){return this.getX1()+this.getWidth()};this.getY2=function(){return this.getY1()+this.getHeight()};this.getData=function(){return data}}Rect.prototype.isCross=function(other){var maxMinX=Number.getMaxMin([this.getX1(),this.getX2(),other.getX1(),other.getX2()]);var maxMinY=Number.getMaxMin([this.getY1(),this.getY2(),other.getY1(),other.getY2()]);var widthX=Math.abs(maxMinX.max-maxMinX.min);var width=this.getWidth()+other.getWidth();var heightY=Math.abs(maxMinY.max-maxMinY.min);var height=this.getHeight()+other.getHeight();if(width<widthX||height<heightY){return false}return true};Rect.prototype.toString=function(){var string="x: "+this.getX1()+", y: "+this.getY1()+", w: "+this.getWidth()+", h: "+this.getHeight();return string};function RandomPosition(rectArr,canvasSize,tryCount){this._rectArr=rectArr;this._canvasSize=canvasSize;this._tryCount=tryCount||1000;this._result=[];this._continue=true}RandomPosition.prototype.randomPosition=function(){return[Math.ceil(Math.random()*this._canvasSize[0])%this._canvasSize[0],Math.ceil(Math.random()*this._canvasSize[0])%this._canvasSize[1]]};RandomPosition.prototype.isAnyCross=function(rect){for(var i in this._rectArr){if(this._result[i].isCross(rect)){return true}}return false};RandomPosition.prototype.calculate=function(){var result=this._result=[];var source=this._rectArr;var size=this._canvasSize;var rect,oldRect,x,y,w,h,maxY=0;for(var i=0,len=source.length;i<len;i++){w=source[i][0];h=source[i][1];if(oldRect){x=oldRect.getX1()+oldRect.getWidth();y=0;if(maxY<oldRect.getY2()){maxY=oldRect.getY2()}}else{x=y=0}if(x+w>size[0]){x=0;y=maxY}rect=new Rect(x,y,w,h,source[i][2]);oldRect=rect;result.push(rect)}var total=result.length,count=total-1,pos,currRect,newRect,tryCount=0,isTimeout=false;while(this._continue&&count>=0){currRect=result[count];isTimeout=false;do{pos=this.randomPosition();if(tryCount++>this._tryCount){this.out("RandomPosition timeout - currentPos: "+pos);count--;isTimeout=true;break}}while(this._continue&&(pos[0]+currRect.getWidth()>=size[0]||pos[1]+currRect.getHeight()>=size[1]));if(isTimeout){continue}newRect=new Rect(pos[0],pos[1],currRect.getWidth(),currRect.getHeight());if(this.isAnyCross(newRect)){continue}else{currRect.setX1(pos[0]);currRect.setY1(pos[1]);count--}}if(this._callback){this.out("RandomPosition get the result");this._callback.call(this,this.getResult())}};RandomPosition.prototype.start=function(callback){this._continue=true;this._callback=callback;var that=this;that.calculate()};RandomPosition.prototype.abort=function(){this._continue=false;if(this._timer){clearTimeout(this._timer)}};RandomPosition.prototype.getResult=function(){this.abort();return this._result};RandomPosition.prototype.out=function(msg){};(function($){var Switcher=function(opt){opt=opt||{};this._arr={};this._event=opt.triggerEvent||"click"};Switcher.prototype.add=function(opt){this._arr[opt.id]=opt};Switcher.prototype.init=function(){for(var i in this._arr){var s=this._arr[i];if(s.trigger){s.trigger.bind(this._event,{switcher:this,id:s.id},function(e){e.data.switcher.switchTo(e.data.id)})}}};Switcher.prototype.switchTo=function(id){for(var i in this._arr){var s=this._arr[i];if(i==id){s.enable()}else{s.disable()}}};Switcher.prototype.enableAll=function(){for(var i in this._arr){var s=this._arr[i];s.enable()}};Switcher.prototype.disableAll=function(){for(var i in this._arr){var s=this._arr[i];s.disable()}};Switcher.prototype.get=function(id){return this._arr[id]};$.Switcher=Switcher})(jQuery);(function($){var Bubble=function(opt){var $container=$('<div class="bubble-container"></div>');var $pointer=$('<span class="bubble-arrow-pointer"></span>');var $body=$(opt.content);$container.append($pointer);$container.append($body);$body.css("dispaly","inline").show();var pointerPos=opt.position.split(" ");$pointer.css(pointerPos[0],"-10px");$pointer.css(pointerPos[1],"10px");if(opt.style){$container.css(opt.style)}if(opt.className){$container.addClass(opt.className)}$container.hide();$(document.body).append($container);this._container=$container;this._pointer=$pointer;this._body=$body;this._position=opt.position;this._defaultTarget=opt.defaultTarget};Bubble.prototype.show=function($target){$target=$target||this._defaultTarget||null;if($target){var targetOffset=$target.offset(),$container=this._container,postions=this._position.split(" "),top="50%",left="50%";this._pointer.addClass("bubble-arrow-pointer-"+postions[0]);switch(postions[0]){case"top":top=targetOffset.top+$target.height()+10;break;case"bottom":top=targetOffset.top-$container.height()-10;break;case"left":left=targetOffset.left+$target.width()+10;break;case"right":left=targetOffset.left-$container.width()-10;break;default:break}switch(postions[1]){case"top":top=targetOffset.top-10;break;case"bottom":top=targetOffset.top-$container.height()+$target.height()/2+20;break;case"left":left=targetOffset.left+$target.width()/2-20;break;case"right":left=targetOffset.left-$container.width()+$target.width()/2+20;break;default:break}$container.css({top:top,left:left})}this._container.show()};Bubble.prototype.hide=function(){this._container.hide()};Bubble.prototype.isShow=function(){return this._container.css("display")!=="none"};Bubble.prototype.setHtml=function(html){this._body.html(html)};Bubble.prototype.setPosition=function(_position){this._position=_position};$.fn.bubble=function(opt,args){if(typeof(opt)=="object"){var $this=$(this);var bubble=$this.data("bubble");if(bubble){return bubble}if(opt.position){var pos=opt.position.split(" ");if(pos.length<2){pos=pos[0];if(pos=="top"||pos=="bottom"){opt.position+=" right"}else{opt.position="top"+opt.position}}}else{opt.position="top right"}opt.content=opt.content||$this;bubble=new Bubble(opt);$this.data("bubble",bubble);return bubble}else{if(typeof(opt)=="string"){var bubble=$(this).data("bubble");if(bubble){bubble[opt](args)}else{throw"bubble: havn't init!"}}else{throw"bubble: argument error!"}}}})(jQuery);(function($){var Loading=function(loadingEl,defaultTarget){this._loadingEl=loadingEl;this._defaultTarget=defaultTarget};Loading.prototype.isShow=function(){return this._loadingEl.css("display")!="none"};Loading.prototype.show=function(target){target=target||this._defaultTarget;this._loadingEl.appendTo(target).center().show()};Loading.prototype.hide=function(){this._loadingEl.hide()};$.Loading=Loading})(jQuery);(function($){var timerShow=function(el,timeout){timeout=timeout||3000;if(el.__timer){clearTimeout(el.__timer)}var timerShowTimout=function(){el.__timer=null;el.hide()};el.show();el.__timer=setTimeout(timerShowTimout,timeout)};var timerHide=function(el){if(el.__timer){clearTimeout(el.__timer)}el.hide()};$.timerShow=timerShow;$.timerHide=timerHide})(jQuery);$(function(){var $container=$("#container"),$tabsContainer=$("#tabsContainer"),$dataLoading=$("#dataLoading"),$footer=$("#footer"),$bubbleTip=$("#bubbleTip"),$chartContainers=$(".chartcontainer"),$tabsCustombtns=$("#tabsCustombtns"),$gobackButton=$("#gobackButton"),$chartTip=$("#chartTip"),$startYear=$("#chartStartYear"),$endYear=$("#chartEndYear"),$startMonth=$("#chartStartMonth"),$endMonth=$("#chartEndMonth"),$chartDrawBtn=$("#chartDrawBtn"),$listAllCateButton=$("#listAllCateButton"),$statisTypeLoading=$("#statisTypeLoading"),$cateContainer=$("#cateContainer"),$selectedCateContainer=$("#selectedCateContainer"),$statisSumExpend=$("#statisSumExpend"),$statisSumEarning=$("#statisSumEarning"),$statisSumSurplus=$("#statisSumSurplus"),$statisSumLoading=$("#statisSumLoading");var CONST={YEARS:[2010,2011],MONTHS:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],CHART_PREFIX:"chartcontainer-",GET_IO_TYPE_URL:"ajaxService/get-account-type.php",GET_STATIS_BY_TYPE_URL:"ajaxService/get-statis-by-type.php",GET_ACCOUNT_STATIS_URL:"ajaxService/get-account-statis.php",GET_ACCOUNT_SUMMARY_URL:"ajaxService/get-account-summary.php"};var dataLoading,accountDataIsLoading=false,drawCharBtnClicked=false,loadingChartType,ioTypeCache,bubbleTipTimeout,topZindex=10000;var observer={onTabSelected:function(event,ui){loadingChartType=ui.tab.getAttribute("name");$chartContainers.hide();if(bubbleTipTimeout){clearTimeout(bubbleTipTimeout)}$bubbleTip.bubble("setHtml",'<div style="width: 100px;padding: 5px 8px;">click me to start !</div>');$bubbleTip.bubble("show",$chartDrawBtn);bubbleTipTimeout=setTimeout(function(){$bubbleTip.bubble("hide")},3000)},onIoTypeDataLoad:function(data){$statisTypeLoading.hide();if(data.success){ioTypeCache={"1":data.inType,"0":data.outType};drawIoType()}else{alert(data.code)}},onAccountDataLoad:function(data){accountDataIsLoading=false;if(data.success){dataLoading.hide();var id=CONST.CHART_PREFIX+loadingChartType;drawChart(id,loadingChartType,data)}else{alert(data.code)}},onListAllCateButtonClick:function(){if(!ioTypeCache){$statisTypeLoading.show();ajaxInteraction.loadIoTypeData()}else{$cateContainer.slideDown()}},onLoadDataButtonClick:function(){hideTips();var startYear=$startYear.val(),endYear=$endYear.val(),startMonth=$startMonth.val(),endMonth=$endMonth.val();var start=startYear+startMonth;var end=endYear+endMonth;if(~~start>~~end){showTips("结束月份必须大于等于开始月份!");return}var param={startYear:startYear,endYear:endYear,startMonth:startMonth,endMonth:endMonth};if(loadingChartType==="bar"){var typeArr=[];$selectedCateContainer.children().each(function(i,item){typeArr.push(item.getAttribute("value"))});if(!typeArr){showTips("请至少选择一个分类!");return}param.cate="["+typeArr+"]"}loadChartData(param)},onSummaryDataLoad:function(data){$statisSumLoading.hide();if(data.success){drawSummaryData(data)}else{alert(data.code)}},onCategoryStatisDataLoad:function(data){accountDataIsLoading=false;if(data.success){dataLoading.hide();var id=CONST.CHART_PREFIX+loadingChartType;drawChart(id,loadingChartType,data)}else{alert(data.code)}}};var ajaxInteraction={loadIoTypeData:function(){$.post(CONST.GET_IO_TYPE_URL,observer.onIoTypeDataLoad)},loadAccountData:function(data){$.post(CONST.GET_ACCOUNT_STATIS_URL,data,observer.onAccountDataLoad)},loadSummaryData:function(){$.post(CONST.GET_ACCOUNT_SUMMARY_URL,observer.onSummaryDataLoad)},loadCategoryStatisData:function(data){$.post(CONST.GET_STATIS_BY_TYPE_URL,data,observer.onCategoryStatisDataLoad)}};var configs={tabsConfig:{selected:-1,select:observer.onTabSelected}};var loadSummaryData=function(){ajaxInteraction.loadSummaryData()};var drawSummaryData=function(data){var records=data.records;var outgo=Number.format(records.out||0,"#.00"),income=Number.format(records["in"]||0,"#.00"),surplus=Number.format(income-outgo,"#.00");$statisSumExpend.text(outgo);$statisSumEarning.text(income);$statisSumSurplus.text(surplus)};var loadChartData=function(param){if(accountDataIsLoading){return}dataLoading.show($tabsContainer);accountDataIsLoading=true;if(loadingChartType==="line"){ajaxInteraction.loadAccountData(param)}else{if(loadingChartType==="bar"){ajaxInteraction.loadCategoryStatisData(param)}}};var drawIoType=function(){if(!ioTypeCache){return}var itemsHtml="",it,types;for(var i in ioTypeCache){types=ioTypeCache[i];for(var t in types){it=types[t];itemsHtml+='<span class="cate-item border1" value="'+it.id+'">'+it.name+"</span>"}}$cateContainer.html(itemsHtml);$(".cate-container").sortable({connectWith:".cate-container",items:".cate-item",revert:"invalid"});$cateContainer.slideDown()};var drawChart=function(id,type,data){$.jqplot.config.enablePlugins=true;switch(type){case"line":drawLineChart(id,data);break;case"bar":drawBarChart(id,data);break;case"pie":drawPieChart(id,data);break;default:break}};var drawLineChart=function(id,data){var $chart=$("#"+id),records=data.records;var drawData=[],drawLabel=[];if(records.out){drawData.push(records.out);drawLabel.push({label:"支出"})}if(records["in"]){drawData.push(records["in"]);drawLabel.push({label:"收入"})}if(drawData.length==0){showTips(data.params[0]+"至"+data.params[1]+"没有收支数据");$chart.hide();return}$chart.empty().height("500px").width("100%").show();var yLimit=findMaxMin(drawData);var maxY=Math.floor(yLimit[0]/1000)*1000+2000;var minY=Math.floor(yLimit[1]/1000)*1000;$.jqplot(id,drawData,{title:data.params[0]+"至"+data.params[1]+"收支趋势图",legend:{show:true,location:"ne"},axes:{xaxis:{min:1,max:12,renderer:$.jqplot.CategoryAxisRenderer},yaxis:{min:minY,max:maxY,tickInterval:1000,tickOptions:{formatString:"$%.2f"}}},series:drawLabel,seriesDefaults:{renderer:$.jqplot.LineRenderer,pointLabels:{formatString:"%.2f",show:true}},highlighter:{showTooltip:false}})};var drawBarChart=function(id,data){var $chart=$("#"+id),records=data.records;var drawData=[],drawLabel=[];for(var i in records){drawData.push(records[i]);drawLabel.push({label:i})}if(drawData.length==0){showTips("所选择的分类没有收支数据");$chart.hide();return}$chart.empty().height("400px").width("100%").show();var yLimit=findMaxMin(drawData);var maxY=Math.floor(yLimit[0]/200)*200+200;var minY=Math.floor(yLimit[1]/200)*200;$.jqplot(id,drawData,{title:data.params[0]+"至"+data.params[1]+"收支分类比较图",axes:{xaxis:{min:1,max:12,renderer:$.jqplot.CategoryAxisRenderer},yaxis:{min:minY,max:maxY,tickInterval:100,tickOptions:{formatString:"$%.2f"}}},legend:{show:true,location:"ne"},series:drawLabel,seriesDefaults:{renderer:$.jqplot.BarRenderer,pointLabels:{formatString:"%.2f",show:true}},highlighter:{show:false}})};var drawPieChart=function(id,data){var $chart=$("#"+id);var drawData=[],drawLabel=[];if(data.out){drawData.push(data.out);drawLabel.push({label:"支出"})}if(drawData.length==0){showTips(data.params[0]+"至"+data.params[1]+"没有收支数据");$chart.hide();return}$chart.empty().height("300px").width("100%").show();$.jqplot(id,drawData,{title:data.params[0]+"至"+data.params[1]+"支出饼图",seriesDefaults:{renderer:$.jqplot.PieRenderer,pointLabels:{formatString:"%.2f",show:true}},highlighter:{show:false}})};var getFillArrayKey=function(o){return o[0]};var fillArray=function(array,getKeyFunc){if(array.length==12){return array}for(var start=1,end=12;start<=end;start++){var a=array[start-1];if(a){if(getKeyFunc(a)==start){continue}else{var differ=getKeyFunc(a)-start;for(var d=0;d<differ;d++){array.splice(start+d-1,0,[start+d,0])}}}else{array.splice(start-1,0,[start,0])}}return array};var numberSortFuncton=function(a,b){if(~~a<~~b){return 1}else{return -1}};var findMaxMin=function(arr){var arrStr=arr.toString().replace(/\d+\-\d+,?/g,"");arr=arrStr.split(",");arr.sort(numberSortFuncton);return[arr[0],arr[arr.length-1]]};var showTips=function(text){$chartTip.text(text);$chartTip.show()};var hideTips=function(){$chartTip.hide()};dataLoading=new $.Loading($dataLoading,$container);$bubbleTip.bubble({style:{"z-index":topZindex+1},className:"border3 corner5",position:"top left"});$tabsContainer.tabs(configs.tabsConfig);$gobackButton.button();$chartDrawBtn.button().click(observer.onLoadDataButtonClick);$startYear.change(function(){var selectedValue=this.value;$endYear.empty();for(var y=selectedValue,end=CONST.YEARS[1];y<=end;y++){$endYear.append('<option value="'+y+'">'+y+"</option>")}});for(var y=CONST.YEARS[0],end=CONST.YEARS[1];y<=end;y++){$startYear.append('<option value="'+y+'">'+y+"</option>");$endYear.append('<option value="'+y+'">'+y+"</option>")}for(var m=0;m<CONST.MONTHS.length;m++){$startMonth.append('<option value="'+(m+1)+'">'+CONST.MONTHS[m]+"</option>");$endMonth.append('<option value="'+(m+1)+'">'+CONST.MONTHS[m]+"</option>")}var now=new Date();var nowYear=now.getFullYear();var nowMonth=now.getMonth()+1;$endYear.val(nowYear);$endMonth.val(nowMonth);$startYear.val(nowYear-1);$startMonth.val(nowMonth);$listAllCateButton.button().click(observer.onListAllCateButtonClick);var onInitReady=function(){setTimeout(loadSummaryData,500)};$container.fadeIn("slow",function(){$(document.body).removeClass("bodyLoading");$footer.slideDown("slow",onInitReady);$tabsCustombtns.fadeIn();$tabsContainer.tabs("select",0)})});